--   -------------------------------------------------- 
--   Generated by Enterprise Architect Version 11.0.1106
--   Created On : 星期三, 19 九月, 2018 
--   DBMS       : MySql 
--   -------------------------------------------------- 


SET FOREIGN_KEY_CHECKS=0;


--  Drop Tables, Stored Procedures and Views 

DROP TABLE IF EXISTS `account` CASCADE
;
DROP TABLE IF EXISTS `account_detail` CASCADE
;
DROP TABLE IF EXISTS `account_portal` CASCADE
;

--  Create Tables 
CREATE TABLE `account`
(
	`id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '自增长id',
	`identity` NVARCHAR(128) NOT NULL DEFAULT '' COMMENT '后台给用户生成的唯一账户标识',
	`remark` NVARCHAR(256) NOT NULL DEFAULT '' COMMENT '备注信息',
	`enable` TINYINT NOT NULL DEFAULT 1 COMMENT '是否启用。1启用     0未启用',
	`create_time` DATETIME(0) NOT NULL DEFAULT now(),
	`update_time` DATETIME(0) NOT NULL DEFAULT now(),
	PRIMARY KEY (`id`),
	UNIQUE `UQ_account`(`identity`)

)  COMMENT='用户账户信息'
;


CREATE TABLE `account_detail`
(
	`id` BIGINT NOT NULL AUTO_INCREMENT,
	`account_identity` NVARCHAR(128) NOT NULL DEFAULT '' COMMENT '关联的账户唯一标识',
	`role` SMALLINT NOT NULL DEFAULT 1 COMMENT '账户角色： 1家长 2老师 3学生（预留）',
	`sex` TINYINT NOT NULL DEFAULT 1 COMMENT '性别： 1男 2女 3未知',
	`nick_name` NVARCHAR(32) DEFAULT '' COMMENT '昵称',
	`description` NVARCHAR(256) DEFAULT '' COMMENT '自我介绍信息',
	PRIMARY KEY (`id`),
	UNIQUE `UQ_account_detail_account_identity`(`account_identity`)

)  COMMENT='账户详细信息表'
;


CREATE TABLE `account_portal`
(
	`id` BIGINT NOT NULL AUTO_INCREMENT,
	`account_identity` NVARCHAR(128) NOT NULL DEFAULT '' COMMENT '所属的主账户唯一标识',
	`portal_type` SMALLINT NOT NULL DEFAULT 1 COMMENT '账户入口类型： 1手机号账户 2邮箱账户 3微信授权账户 4用户密码登录账户 ...',
	`identity` NVARCHAR(128) NOT NULL DEFAULT '' COMMENT '该账户入口渠道的账户唯一标识。根据type不同，这里分别可能是： 1、手机号 2、邮箱 3、账户名 4、微信openId ...',
	`auth_token` NVARCHAR(128) NOT NULL DEFAULT '' COMMENT '账户的鉴权密钥。根据type不同可能是： 文本账户密码、邮箱账户密码',
	`enable` TINYINT DEFAULT 1 COMMENT '是否可用',
	`create_time` DATETIME(0) NOT NULL DEFAULT now(),
	`update_time` DATETIME(0) NOT NULL DEFAULT now(),
	PRIMARY KEY (`id`),
	UNIQUE `UQ_account_portal_identity`(`identity`, `portal_type`)

)  COMMENT='账户入口信息表'
;



SET FOREIGN_KEY_CHECKS=1;
